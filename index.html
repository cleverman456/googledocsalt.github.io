<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" id="favicon" href="https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; margin:0; padding:0; }
  html { height:100%; }
  body { font-family:"Inter",sans-serif; min-height:100vh; color:#fff; background:#0f1115; overflow-x:hidden; transition: background 0.3s, color 0.3s; }
  #stars { position: fixed; top:0; left:0; width:100%; height:100%; z-index:0; pointer-events:none; }
  .site { position: relative; z-index:2; min-height:100vh; }
  header { padding:32px 20px 20px; text-align:center; display:flex; flex-direction:column; gap:12px; }
  header h1 { font-size:2.2rem; font-weight:700; letter-spacing:-0.5px; }
  header p { color:#9aa0aa; font-size:0.95rem; }
  .header-controls { display:flex; gap:10px; margin-top:12px; width:100%; max-width:550px; justify-content:center; flex-wrap:wrap; }
  .header-controls input, .header-controls select { flex:1; padding:10px 14px; border-radius:12px; border:none; background:#1c1f28; color:#fff; font-size:1rem; appearance:none; cursor:pointer; }
  .header-controls button { padding:10px 14px; border:none; border-radius:12px; background:#2c3040; color:#fff; cursor:pointer; transition:0.15s; }
  .header-controls button:hover { background:#393f55; }
  .games-wrapper { max-width:1300px; margin:0 auto; padding:20px; }
  .games-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:18px; }
  .game-card { background: rgba(22,25,34,0.95); border-radius:18px; overflow:hidden; cursor:pointer; transition: transform 0.18s ease, box-shadow 0.18s ease; box-shadow:0 6px 18px rgba(0,0,0,0.22); display:flex; flex-direction:column; }
  .game-card:hover { transform: translateY(-6px); box-shadow:0 12px 28px rgba(0,0,0,0.42); }
  .game-thumb { width:100%; aspect-ratio:1/1; background:linear-gradient(180deg,#222 0%,#1a1c20 100%); background-size:cover; background-position:center; position:relative; display:block; }
  .play-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(3,122,255,0.12); color:#e7f6ff; font-size:1rem; font-weight:700; opacity:0; transition:opacity 0.18s ease; }
  .game-card:hover .play-overlay { opacity:1; }
  .game-info { padding:12px 14px 16px; flex:1; display:flex; flex-direction:column; justify-content:space-between; }
  .game-title { font-weight:600; font-size:0.95rem; margin-bottom:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .game-meta { font-size:0.75rem; color:#9aa0aa; }
  .modal-bg { position:fixed; inset:0; background: rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; z-index:1000; }
  .modal-window { width:92%; max-width:700px; background:#181b24; border-radius:14px; overflow:hidden; display:flex; flex-direction:column; }
  .modal-header { padding:12px 18px; background:#20232d; border-bottom:1px solid #2a2f3a; display:flex; justify-content:space-between; align-items:center; font-weight:600; color:#e6eef8; }
  .close-btn { cursor:pointer; font-size:1.3rem; }
  .modal-content { padding:20px; display:flex; flex-direction:column; gap:15px; color:#ccc; }
  .toggle-row { display:flex; align-items:center; justify-content:space-between; }
  .toggle-row label { font-weight:600; }
  .dropdown { padding:10px; border-radius:10px; border:none; background:#1c1f28; color:#fff; font-size:1rem; cursor:pointer; appearance:none; }
  .theme-dark { background:#0f1115; color:#fff; }
  .theme-light { background:#f5f5f5; color:#111; }
</style>
</head>
<body>
<canvas id="stars"></canvas>
<div class="site">
  <header>
    <h1 id="siteTitle">Google Docs</h1>
    <p>Instant play. No limits. Just games.</p>
    <div class="header-controls">
      <input type="text" id="gameSearch" placeholder="Search games...">
      <button id="settingsBtn">⚙ Settings</button>
    </div>
  </header>
  <main class="games-wrapper">
    <div class="games-grid" id="gamesGrid"></div>
  </main>
</div>

<script>
const githubUser = "cleverman456";
const githubRepo = "googledocsalt.github.io";
const githubBranch = "main";
const gamesFolder = "assets";

const starsCanvas = document.getElementById("stars");
const dpr = Math.max(1, window.devicePixelRatio || 1);

function setupCanvas(){
  const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
  const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
  starsCanvas.width = Math.round(vw*dpr);
  starsCanvas.height = Math.round(vh*dpr);
  starsCanvas.style.width = vw + "px";
  starsCanvas.style.height = vh + "px";
  const ctx = starsCanvas.getContext("2d");
  ctx.setTransform(dpr,0,0,dpr,0,0);
  return {ctx,vw,vh};
}
let {ctx,vw,vh} = setupCanvas();
let stars = [];
function createStars(){
  const count = Math.round((vw*vh)/9000);
  stars = new Array(count).fill(0).map(()=>({x:Math.random()*vw,y:Math.random()*vh,r:Math.random()*1.4+0.3,speed:Math.random()*0.25+0.03,twinkle:Math.random()*Math.PI*2}));
}
function drawStars(){
  ctx.clearRect(0,0,vw,vh);
  for(const s of stars){
    s.y+=s.speed; s.twinkle+=0.03;
    if(s.y>vh+10)s.y=-10;
    const alpha=0.55+Math.sin(s.twinkle)*0.45;
    ctx.beginPath(); ctx.fillStyle=`rgba(255,255,255,${alpha})`; ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
  }
  requestAnimationFrame(drawStars);
}
createStars(); drawStars();
addEventListener("resize",()=>{ const r=setupCanvas(); ctx=r.ctx; vw=r.vw; vh=r.vh; createStars(); });

// ---------- Game Loader ----------
const categories = ["Action","Puzzle","Adventure","Sports","Strategy"];
let allGames = [];

async function loadGameFiles(){
  const api=`https://api.github.com/repos/${githubUser}/${githubRepo}/contents/${gamesFolder}`;
  const res = await fetch(api);
  const files = await res.json();
  if(!Array.isArray(files)) return [];
  return files.filter(f=>f.name && f.name.endsWith(".html")).map(f=>{
    const slug=f.name.replace(".html",""); 
    const title=slug.replace(/-/g," ");
    const category = categories[Math.floor(Math.random()*categories.length)];
    return {slug,title,category};
  });
}

function buildCardElement(game, thumb="https://via.placeholder.com/300x300?text=Game"){
  const el = document.createElement("div");
  el.className="game-card";
  el.setAttribute("data-slug",game.slug);
  el.setAttribute("data-title",game.title.toLowerCase());
  el.setAttribute("data-category",game.category);
  el.innerHTML=`
    <div class="game-thumb" style="background-image:url('${thumb}')">
      <div class="play-overlay"><span class="icon">▶</span>Play Now</div>
    </div>
    <div class="game-info">
      <div style="min-width:0">
        <div class="game-title">${game.title}</div>
        <div class="game-meta">${game.category}</div>
      </div>
    </div>
  `;
  el.onclick=()=>openGame(game.slug,game.title);
  return el;
}

function openGame(slug,title){
  const modal=document.createElement("div");
  modal.className="modal-bg";
  modal.innerHTML=`
    <div class="modal-window">
      <div class="modal-header">
        <span>${title}</span>
        <span class="close-btn" onclick="this.closest('.modal-bg').remove()">✖</span>
      </div>
      <iframe src="${gamesFolder}/${slug}.html" class="game-frame"></iframe>
    </div>
  `;
  document.body.appendChild(modal);
}

// ---------- Search ----------
document.getElementById("gameSearch").addEventListener("input",e=>{
  const term=e.target.value.toLowerCase();
  document.querySelectorAll(".game-card").forEach(card=>{
    const title = card.getAttribute("data-title");
    const category = card.getAttribute("data-category");
    if(title.includes(term) || category.includes(term)) card.style.display="flex";
    else card.style.display="none";
  });
});

// ---------- Settings ----------
const themes = {"Default":"theme-dark","Light":"theme-light"};
const cloakTemplates = {
  "Google Docs":{title:"Google Docs",favicon:"https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png"},
  "Google Drive":{title:"Google Drive",favicon:"https://upload.wikimedia.org/wikipedia/commons/1/10/Google_Drive_logo.png"},
  "Clever":{title:"Clever",favicon:"https://www.clever.com/favicon.ico"}
};

document.getElementById("settingsBtn").addEventListener("click",()=>{
  const modal=document.createElement("div");
  modal.className="modal-bg";
  modal.innerHTML=`
    <div class="modal-window">
      <div class="modal-header">
        <span>Settings</span>
        <span class="close-btn" onclick="this.closest('.modal-bg').remove()">✖</span>
      </div>
      <div class="modal-content">
        <div class="toggle-row">
          <label for="aboutBlankToggle">Open in about:blank every time</label>
          <input type="checkbox" id="aboutBlankToggle">
        </div>
        <div class="toggle-row">
          <label for="themeSelect">Theme</label>
          <select id="themeSelect" class="dropdown"></select>
        </div>
        <div class="toggle-row">
          <label for="cloakSelect">Cloak site as</label>
          <select id="cloakSelect" class="dropdown"></select>
        </div>
        <button id="applySettingsBtn" style="padding:10px;border-radius:10px;border:none;background:#2c3040;color:#fff;cursor:pointer;">Apply Settings</button>
      </div>
    </div>
  `;
  document.body.appendChild(modal);

  // Populate dropdowns
  const themeSelect=document.getElementById("themeSelect");
  for(const t in themes) themeSelect.innerHTML+=`<option value="${themes[t]}">${t}</option>`;
  const cloakSelect=document.getElementById("cloakSelect");
  for(const t in cloakTemplates) cloakSelect.innerHTML+=`<option value="${t}">${t}</option>`;

  document.getElementById("applySettingsBtn").onclick=()=>{
    const selectedTheme=themeSelect.value;
    document.body.className=selectedTheme;

    const selectedCloak=cloakSelect.value;
    document.getElementById("siteTitle").textContent=cloakTemplates[selectedCloak].title;
    document.getElementById("favicon").href=cloakTemplates[selectedCloak].favicon;

    const aboutBlank=document.getElementById("aboutBlankToggle").checked;
    if(aboutBlank) localStorage.setItem("openAboutBlank","true");
    else localStorage.removeItem("openAboutBlank");

    modal.remove();
  };
});

// Open in about:blank
if(localStorage.getItem("openAboutBlank")==="true" && location.href.indexOf("about:blank")===-1){
  window.open("about:blank","_self");
}

// ---------- Load games ----------
(async()=>{
  const grid=document.getElementById("gamesGrid");
  allGames=await loadGameFiles();
  categories.forEach(cat=>{
    const catDiv=document.createElement("div");
    catDiv.className="game-card";
    catDiv.style.display="flex";
    catDiv.style.alignItems="center";
    catDiv.style.justifyContent="center";
    catDiv.style.fontWeight="600";
    catDiv.style.fontSize="1.1rem";
    catDiv.style.padding="20px";
    catDiv.style.background="#1a1c20";
    catDiv.textContent=cat;
    catDiv.onclick=()=>showCategory(cat);
    grid.appendChild(catDiv);
  });
})();

function showCategory(cat){
  const grid=document.getElementById("gamesGrid");
  grid.innerHTML="";
  const games = allGames.filter(g=>g.category===cat);
  games.forEach(game=>{
    const card = buildCardElement(game);
    grid.appendChild(card);
  });
}
</script>
</body>
</html>
