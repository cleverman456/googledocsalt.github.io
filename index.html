<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link id="favicon" rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
html{height:100%;background:#0f1115}
body{
  min-height:100vh;
  font-family:Inter,sans-serif;
  background:transparent;
  color:#fff;
  overflow-x:hidden
}
#stars{
  position:fixed;
  inset:0;
  z-index:0;
  pointer-events:none
}
.site{position:relative;z-index:2;min-height:100vh}

header{
  padding:32px 20px 20px;
  text-align:center
}
header h1{
  font-size:2.2rem;
  font-weight:700;
  letter-spacing:-.5px
}
header p{
  margin-top:8px;
  color:#9aa0aa;
  font-size:.95rem
}

.search-wrap{
  margin:18px auto 10px;
  max-width:520px;
  display:flex;
  gap:10px;
  justify-content:center
}
.search-wrap input{
  flex:1;
  padding:10px 14px;
  border-radius:12px;
  border:none;
  background:#1c1f28;
  color:#fff;
  font-size:1rem
}
.search-wrap button{
  padding:10px 14px;
  border-radius:12px;
  border:none;
  background:#2c3040;
  color:#fff;
  cursor:pointer;
  transition:.15s
}
.search-wrap button:hover{background:#393f55}

.games-wrapper{
  max-width:1300px;
  margin:0 auto;
  padding:20px
}
.games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:18px
}
.game-card{
  background:rgba(22,25,34,.95);
  border-radius:18px;
  overflow:hidden;
  cursor:pointer;
  transition:.18s;
  box-shadow:0 6px 18px rgba(0,0,0,.22)
}
.game-card:hover{
  transform:translateY(-6px);
  box-shadow:0 12px 28px rgba(0,0,0,.42)
}
.game-thumb{
  width:100%;
  aspect-ratio:1/1;
  background:linear-gradient(180deg,#222,#1a1c20);
  background-size:cover;
  background-position:center;
  position:relative
}
.play-overlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(3,122,255,.12);
  font-weight:700;
  opacity:0;
  transition:.18s
}
.game-card:hover .play-overlay{opacity:1}
.game-info{padding:12px 14px 16px}
.game-title{
  font-weight:600;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis
}
.game-meta{
  font-size:.75rem;
  color:#9aa0aa
}

/* MODAL */
.modal-bg{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1000
}
.modal-window{
  width:92%;
  max-width:1100px;
  height:84%;
  background:#181b24;
  border-radius:14px;
  display:flex;
  flex-direction:column;
  overflow:hidden
}
.modal-header{
  padding:12px 18px;
  background:#20232d;
  border-bottom:1px solid #2a2f3a;
  display:flex;
  justify-content:space-between;
  font-weight:600
}
.modal-footer{
  padding:10px;
  background:#20232d;
  border-top:1px solid #2a2f3a;
  display:flex;
  justify-content:space-between
}
.modal-footer button{
  background:#2c3040;
  border:none;
  padding:10px 14px;
  border-radius:10px;
  color:#fff;
  cursor:pointer
}
.game-frame{flex:1;border:none;background:#000}
</style>
</head>

<body>
<canvas id="stars"></canvas>

<div class="site">
<header>
  <h1 id="siteTitle">Google Docs</h1>
  <p>Instant play. No limits. Just games.</p>
  <div class="search-wrap">
    <input id="search" placeholder="Search games...">
    <button id="settingsBtn">⚙</button>
  </div>
</header>

<main class="games-wrapper">
  <div class="games-grid" id="grid"></div>
</main>
</div>

<script>
/* ===== STAR BACKGROUND ===== */
const canvas=document.getElementById("stars");
const ctx=canvas.getContext("2d");
let w,h,stars=[];
function resize(){
  w=canvas.width=innerWidth;
  h=canvas.height=innerHeight;
  stars=Array.from({length:(w*h)/9000},()=>({
    x:Math.random()*w,
    y:Math.random()*h,
    r:Math.random()*1.4+.3,
    s:Math.random()*.25+.05,
    t:Math.random()*Math.PI*2
  }));
}
function draw(){
  ctx.clearRect(0,0,w,h);
  stars.forEach(s=>{
    s.y+=s.s;
    s.t+=.03;
    if(s.y>h)s.y=-10;
    ctx.beginPath();
    ctx.fillStyle=`rgba(255,255,255,${.55+Math.sin(s.t)*.45})`;
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
  });
  requestAnimationFrame(draw);
}
resize();draw();
addEventListener("resize",resize);

/* ===== about:blank iframe ===== */
if(localStorage.openBlank==="1" && location.hostname){
  const win=window.open("about:blank","_self");
  win.document.write(`
    <style>html,body,iframe{margin:0;width:100%;height:100%;border:none}</style>
    <iframe src="${location.href}"></iframe>
  `);
}

/* ===== LOAD GAMES + IMAGE FINDER ===== */
const user="cleverman456",repo="googledocsalt.github.io";
const grid=document.getElementById("grid");

async function findThumb(slug){
  for(const ext of["png","jpg","jpeg","webp"]){
    const path=`assets/${slug}.${ext}`;
    try{
      const r=await fetch(path,{method:"HEAD"});
      if(r.ok)return path;
    }catch{}
  }
  return "https://via.placeholder.com/300x300?text=Game";
}

fetch(`https://api.github.com/repos/${user}/${repo}/contents/assets`)
.then(r=>r.json())
.then(async files=>{
  for(const f of files.filter(x=>x.name.endsWith(".html"))){
    const slug=f.name.replace(".html","");
    const card=document.createElement("div");
    card.className="game-card";
    card.dataset.title=slug.toLowerCase();
    const thumb=await findThumb(slug);
    card.innerHTML=`
      <div class="game-thumb" style="background-image:url('${thumb}')">
        <div class="play-overlay">▶ Play Now</div>
      </div>
      <div class="game-info">
        <div class="game-title">${slug.replace(/-/g," ")}</div>
        <div class="game-meta">Play Now</div>
      </div>`;
    card.onclick=()=>openGame(slug);
    grid.appendChild(card);
  }
});

/* ===== OPEN GAME ===== */
function openGame(slug){
  const m=document.createElement("div");
  m.className="modal-bg";
  m.innerHTML=`
    <div class="modal-window">
      <div class="modal-header">
        <span>${slug}</span>
        <span onclick="this.closest('.modal-bg').remove()">✖</span>
      </div>
      <iframe src="assets/${slug}.html" class="game-frame"></iframe>
      <div class="modal-footer">
        <button onclick="this.closest('.modal-bg').remove()">Close</button>
        <button onclick="document.querySelector('.game-frame').requestFullscreen()">⛶ Fullscreen</button>
      </div>
    </div>`;
  document.body.appendChild(m);
}

/* ===== SEARCH ===== */
document.getElementById("search").oninput=e=>{
  const q=e.target.value.toLowerCase();
  document.querySelectorAll(".game-card").forEach(c=>{
    c.style.display=c.dataset.title.includes(q)?"":"none";
  });
};

/* ===== SETTINGS (simple toggle retained) ===== */
document.getElementById("settingsBtn").onclick=()=>{
  localStorage.openBlank=localStorage.openBlank==="1"?"":"1";
  alert("about:blank mode " + (localStorage.openBlank?"enabled":"disabled"));
};
</script>
</body>
</html>
